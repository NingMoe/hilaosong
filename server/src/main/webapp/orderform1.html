 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">



<html xmlns="http://www.w3.org/1999/xhtml">



<head>



<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />



<meta http-equiv="x-ua-compatible" content="ie=7" /> 



<title>外卖表单</title>



<link rel="stylesheet" type="text/css" href="style/bootstrap.min.css"/>



<link rel="stylesheet" type="text/css" href="js/fancybox/jquery.fancybox.css"/>



<link rel="stylesheet" type="text/css" href="style/calendar.css"/>



<link rel="stylesheet" type="text/css" href="style/base.css"/>



<link rel="stylesheet" type="text/css" href="style/index.css"/>





<script type="text/javascript"src="js/json2.js"></script>



<script src="js/jquery.min.js"></script>



<script src="js/jquery-migrate.min.js"></script>



<script src="js/jquery-ui.min.js"></script>



<script src="js/jquery.cookie.js"></script>



<script src="js/jquery.fancybox-1.3.4.js"></script>



<script src="js/jquery.mousewheel.js"></script>



<script src="js/jquery.easing.js"></script>



<script src="js/dyndatetime.js"></script>



<script type="text/javascript" src="js/md5.js"></script>



<script src="js/common.js"></script>


<script src="js/web/orderform1.js"></script>



<script src="js/config.js"></script>
<script language="javascript" type="text/javascript" src="js/datepicker/WdatePicker.js"></script>


<script src="js/autocomplete/autocomplete.js"></script>
<link rel="stylesheet" type="text/css" href="js/autocomplete/autocomplete.css"/>


<style>

#feiyong dt{ line-height:32px;}

#feiyong .m_t_10{ float:left; display:block;line-height:32px;margin-left:7px; margin-top:0;}

.orderline{ border-top:1px dashed #CCCCCC; clear:both; margin:4px 0;}

.dish_info .left{margin-left: 20px;}
.dish_info .right{margin-left: 300px;}

</style>

<script>


</script>


<script language="javascript" type="text/javascript" src="js/dinnertime.js"></script><!--//lt:20150919 时间控件方法-->

</head>







<body>



<div id="top1">



<div id="header">



<a href="http://hi.haidilao.com:80/pages/haidl/index.jsp?ssoid=null&customerKey=&loginId=0"><img src="http://hi.haidilao.com:80/pages/haidl/images/logo.png" alt="" id="logo" /></a>











<ul id="nav">







	<li><a href="http://hi.haidilao.com/pages/haidl/index.jsp?ssoid=null&customerKey=&loginId=0#height=362" id="indexTop">Hi捞汇首页</a></li>



	<li>



		<a href="http://hi.haidilao.com/pages/haidl/order_iframe.jsp?url=aHR0cDovL2NhdGVyLmhhaWRpbGFvLmNvbS9DYXRlci9zdG9yZWxpc3QuYWN0aW9uP29yZGVyVHlwZT0xJnNzb2lkPW51bGwmY3VzdG9tZXJLZXk9JmxvZ2luSWQ9MCZ0eXBlPTM=#height=920" >Hi订餐</a>



	</li>



	<li><a href="./"  class="now">Hi捞送</a></li>



	<li>



		<a style="cursor:pointer"  href="http://hi.haidilao.com/pages/haidl/member.jsp?ssoid=null&customerKey=&loginId=0">Hi地盘</a>



	



	</li>



	<li><a style="cursor:pointer"  href="http://hi.haidilao.com:80/pages/promotion/promotion_index.jsp?ssoid=null&customerKey=&loginId=0">Hi活动</a></li>



	<li><a style="cursor:pointer"  href="http://cater.haidilao.com/hifarm/index.html">Hi农场</a></li>



		



</ul>



<div id="user_nav">



	   



	



	欢迎来到Hi捞汇社区！ 



	<a href="http://hi.haidilao.com/pages/haidl/order_iframe.jsp?url=aHR0cDovL2NhdGVyLmhhaWRpbGFvLmNvbTo4MC9DYXRlci93ZWIvY29tbW9uL2FwcE1haW5Eb3dubG9hZC5qc3A/dHlwZT0w" style="cursor:pointer;border-left:1px dotted #FFFFFF;">iPhone版</a>



	<a style="border:none;cursor:pointer" href="http://hi.haidilao.com/pages/haidl/order_iframe.jsp?url=aHR0cDovL2NhdGVyLmhhaWRpbGFvLmNvbTo4MC9DYXRlci93ZWIvY29tbW9uL2FwcE1haW5Eb3dubG9hZC5qc3A/dHlwZT0x">Android版</a>



	<a id ="loginTop" style="cursor:pointer;border-left:1px dotted #FFFFFF;" onclick="loginshow()">登录</a><a href="logins/registerJump.action">注册</a>



	



	<a href="http://hi.haidilao.com:80/pages/haidl/order_iframe.jsp?url=aHR0cDovL2NhdGVyLmhhaWRpbGFvLmNvbTo4MC9DYXRlci9oZWxwL3ByZUhlbHBJbmZvLmFjdGlvbg==">帮助</a>



	<a href="./historyorder.html">订单查询</a>



	<a href="http://www.haidilao.com" style="border:none;cursor:pointer">企业门户</a>

f

</div>







</div>



</div>



<div class="box_01"> 



<div class="left left_01 m_t_15" >



<img src="images/left_img.jpg" width="144" border="0" usemap="#Map" id="id_left_01"/>



  <map name="Map" id="Map">



    <area shape="circle" coords="134,11,8" href="#" onclick="ceng()" />



  </map>



</div>



<div class="left mid">
<div class="step"><img src="images/step4.jpg" /></div>


<div class="mid_left left">



<div class="m_l_title">选择城市</div>



<div class="m_l_menu">



<div class="m_diqu" id="cityname" onclick="citylist()">北京市</div>



<!--<div class="m_adv m_t_10"><img src="images/left_adv_01.jpg" /></div>-->



<ul id="catul">



</ul>



</div>



<div class="sc_date">



送餐时间：11:30-23:00<br />



订餐时间：08:00-23:00



</div>



</div>







<div class="mid_mid left dish_info">











<div class="wm_list">



<div class="orderline"></div>
<dl><dt>联&nbsp;系&nbsp;人：</dt><dd><div class="d_input"><input type="text" readonly="readonly" name="contactName" style=" border:0;" value="" /></div></dd></dl>


<div class="clear"></div>
<div class="orderline"></div>
<dl><dt>手&nbsp;&nbsp;&nbsp;&nbsp;机：</dt><dd><div class="d_input"><input type="text" readonly="readonly" name="contactPhone" style=" border:0;" value="" /></div></dd></dl>


<div class="clear"></div>
<div class="orderline"></div>
<dl><dt>用餐人数：</dt><dd><div class="d_input"><input type="text" readonly="readonly" name="participantNumber" style=" border:0;" value="" /></div></dd></dl>


<div class="clear"></div>
<div class="orderline"></div>
<dl><dt>类&nbsp;&nbsp;&nbsp;&nbsp;型：</dt><dd><div class="d_leixing">



<span ><input type="radio" disabled="disabled" name="orderType" readonly="readonly" value="0" checked="checked" />普通外卖</span>



<span ><input type="radio" disabled="disabled" name="orderType" readonly="readonly" value="2" />上门自取</span>



</div></dd></dl>





<div class="clear"></div>
<div class="orderline"></div>
<dl><dt>地&nbsp;&nbsp;&nbsp;&nbsp;址：</dt><dd ><div class="dd_add d_input" style="height:auto;">



<div class="clear"></div>

<div><span class="m_t_10" style="vertical-align:middle; margin-top:0;">城市：</span><input name="cityname" readonly="readonly" type="text" style="width:270px; border:0; vertical-align:middle;"   value="" /></div>
<div class="clear"></div>

<div id="dizhi">



<!--<span class="m_t_10">地址：</span>--><span class="m_t_10"><input name="detailAddress" readonly="readonly" type="text" style="width:270px; border:0; padding-left:0;" onblur="ordertype0addr(this);"  value="" />



<input type="hidden" name="cityId" value="" />
<input type="hidden" name="provinceId" value="" /><!-- //lt:20151001增加provinceid-->



</span>



</div>



<div id="mendian">



<div class="clear" style="height:10px;"></div>



<span>门店：</span>



<span><select id="storeid2" disabled="disabled" style=" height:32px; line-height:32px; border:0;appearance:none;-moz-appearance:none; -webkit-appearance:none; " readonly="readonly"></select></span>



<div class="clear"></div>



<div>



<span>地址：</span>



<span id="mendiandizhi"></span>



</div>



</div>



<div class="clear"></div>



<div id="storelist" style="display:none;">



<span class="m_t_10">门店：</span><span class="m_t_10">



<input type="text" name="storeId" style="width: 270px" value="020102">



</span>



</div>



<div class="clear" style="height:10px;"></div>



</div></dd></dl>

<div class="clear"></div>





<div id="orderform1">




<!-- lt:20151001 增加线-->
<div class="orderline"></div>


<dl><dt>用餐时间：</dt><dd><div class="d_input d_rili">



<span><input name="dinningTime" type="hidden" id="dinningTime" style="width:160px;"   value="" />
<input id="d12" type="text" class="message_repasttime analyze_parent" desction="选择日期" code="20206" data-max="0" data-min="0"  value="请选择用餐日期"/>
<select id="selHour" class="analyze_parent" desction="时" code="20207" valign="center"></select>
时
<select id="selMin"  class="analyze_parent" desction="分" code="20208" valign="center"></select>
分
</span>


</div></dd></dl>



<!-- lt:20151001 增加线-->
<div class="clear"></div>
<div class="orderline"></div>

<!-- zs: 修改炉具-
<dl><dt>自备炉具</dt><dd><div class="d_leixing">



<span onclick="$('.guoju').hide();$('#potNumber').val('0');$('#panNumber').val('0');getFfeeYfee();"><input type="radio" name="usecup" value="1" /></span><span class="p_r_10">是</span>



<span onclick="$('.guoju').show();getFfeeYfee();"><input type="radio" name="usecup" value="0" checked="checked" /></span><span>否</span>



</div></dd></dl>







<dl class="guoju"><dt style="line-height:40px;">电磁炉</dt><dd style="padding-left:260px;"><div class="left d_num" style="padding-top:10px;"><span><img src="images/img_jian.gif" id="imgjian" /></span>



<span class="f12px fB f_c6000a"><input readonly="readonly" name="potNumber" id="potNumber" type="text" value="0" style="width:24px; height:18px; text-align:center;" /></span>



<span><img src="images/img_jia.gif" id="imgjia" /></span>



</div></dd></dl>
<dl><dt>自备锅具</dt><dd><div class="d_leixing">



<span onclick="$('.luju').hide();$('#potNumber').val('0');$('#panNumber').val('0');getFfeeYfee();"><input type="radio" name="usecup2" value="1" /></span><span class="p_r_10">是</span>



<span onclick="$('.luju').show();getFfeeYfee();"><input type="radio" name="usecup2" value="0" checked="checked" /></span><span>否</span>



</div></dd></dl>
<dl class="luju"><dt style="line-height:40px;">锅具</dt><dd style="padding-left:260px;"><div class="left d_num" style="padding-top:10px;"><span><img src="images/img_jian.gif" id="imgjian1" /></span>



<span class="f12px fB f_c6000a"><input readonly="readonly" name="panNumber" id="panNumber" type="text" value="0" style="width:24px; height:18px; text-align:center;" /></span>



<span><img src="images/img_jia.gif" id="imgjia1" /></span>



</div></dd></dl>

 end.. -->



<!-- lt:20151001 增加线
<div class="clear"></div>
<div class="orderline"></div>
-->

<dl><dt>备注(选填)：</dt><dd><div class="d_input"><input type="text" name="custMemo" value="" /></div></dd></dl>

<div style="height:20px;"></div>


<!-- lt:20151001 增加线-->
<div class="clear"></div>
<div class="orderline"></div>

<dl><dt>是否开发票：</dt><dd><div class="d_leixing">



<span ><input onclick="Sel.needReciept(1)" type="radio" name="needReciept" value="1" /></span><span class="p_r_10">是&nbsp;&nbsp;</span>



<span><input  onclick="Sel.needReciept(0)" type="radio" name="needReciept" value="0" checked="checked" /></span><span>否</span>



</div></dd></dl>



<dl id="fapiao" style="display:none;"><dt>发票类型</dt><dd><div class="d_leixing">



<span onclick="Sel.recieptType(1)"><input type="radio" name="recieptType" value="1" /></span><span class="p_r_10">公司</span>



<span onclick="Sel.recieptType(0)"><input type="radio" name="recieptType" value="0" checked="checked" /></span><span>个人</span>



</div></dd></dl>

<dl id="fapiaott" style="display:none;"><dt>发票抬头</dt><dd><div class="d_input">
<input id="recieptDept" name="recieptDept" type="text" value="" /></div></dd></dl>





</div>







<div id="orderform2" style="display:none;">
















<div class="clear" style=" height:20px;"></div>

<div class="order_title">
    <span class="dishes_name1">名&nbsp;称</span>
	<span class="dishes_num1">单价</span>
	<span class="dishes_price1">数量</span>
    <span class="dishes_price1">价格</span>
</div>





<div id="dishlist" class="cd_list">



<div class="clear"></div>



</div>



<div class="clear"></div>



<dl id="feiyong"><dt>费用</dt><dd><div class="d_input">

<style>
#feiyong #ffee{ display:none;}
#feiyong #yfee{ display:none;}
</style>

<span id="ffee" class="m_t_10">服务费：<input type="text" name="waiterFee" id="waiterFee" readonly="readonly" style="width: 40px; border:0;" value="0"></span>
<span id="yfee"  class="m_t_10">押金：<input type="text" name="depositFee" id="depositFee" readonly="readonly" style="width: 40px; border:0;" value="0"></span>



<span class="m_t_10">外送费：</span><span class="m_t_10"><input type="text" name="deliveryFee" readonly="readonly" id="deliveryFee" style="width: 40px; border:0;" value="0"></span>



<span class="m_t_10">菜品价：</span><span class="m_t_10"><input type="text" name="dishPrice" readonly="readonly" id="dishPrice" style="width: 40px; border:0;" value="88"></span>



<span class="m_t_10">总价:</span><span class="m_t_10"><input type="text" name="totalPrice" readonly="readonly" id="totalPrice" style="width: 50px; border:0;" value="118"></span>



</div></dd></dl>







<dl><dt>支付方式</dt><dd><div class="d_leixing">



<span><input type="radio" name="payChannel" value="2" checked="checked" /></span><span>餐到付款（现金）</span>



<span><input type="radio" name="payChannel" value="3"  /></span><span>餐到付款（POS）</span>



<span><input type="radio" name="payChannel" value="0" /></span><span class="p_r_10">在线支付</span>



</div></dd></dl>







</div>







<div class="clear"></div>



</div>

<script>

$(document).ready(function(e) {
			History.init();

			var needReciept = $.trim($("input[name='needReciept']:checked").val());

			var recieptDept = $.trim($("input[name='recieptDept']").val());
			if(needReciept=="1"){
				$('#fapiao').show();
				if(needReciept=="1"){
					$('#fapiaott').show();
				}
			}
});
//检查时间录入
function checkInputTime(){
	if($("#d12").val() == '' || $("#d12").val() == '请选择用餐日期' ||  $("#selHour").val() == '' || $("#selMin").val() == ''  ){
		alert('请填写时间');
		return true;
	}
	return false;
}

function checktime(start,end){
	var st = new Date(start.replace(/\-/g,'/'));
	var en = new Date(end.replace(/\-/g,'/'));
	var no = new Date();
	U.debug(start+"   end:"+end);
	if(st<no && en>no){
		return true;
	}
	return false;
}

//用户历史信息
var History = {
		init:function(){ 
			History.getHistory('getHistoryUser');
		},
		params: {
			a1:[]
		},
		auto:{},
		getHistory:function(url){
			$.ajax({
						url : apiurl + "getHistoryUser",// ?loginId='+logintmp,
						type : 'GET',
						dataType : 'JSON',// here
						data:{
							type:4
						},
						success : function(data) {
							if (data) {
								var i1=0,i2=0,i3=0;
								function build(param,d,i){
									param[i]={};
									param[i].name = d.info;
									param[i].id = d.id;
								}
								for (var i = 0; i < data.length; i++) {
									var d = data[i];
									var t = d.types;
									if(t==4){
										build(History.params.a1,d,i1);
										i1++;
									}
								}
								History.autocomplete("recieptDept",History.params.a1,440);
							} else {
								alert(data)
							}
						}
					});
		},
		autocomplete:function(id,param,width){
			if(History.auto[id]==null){
				History.auto[id] =   $('#'+id).autocomplete(param, {
	                max: 12,    //列表里的条目数
	                minChars: 0,    //自动完成激活之前填入的最小字符
	                width: width,     //提示的宽度，溢出隐藏
	                scrollHeight: 300,   //提示的高度，溢出显示滚动条
	                matchContains: true,    //包含匹配，就是data参数里的数据，是否只要包含文本框里的数据就显示
	                autoFill: false,    //自动填充
	                isDel:true,
	                formatItem: function(row, i, max) {
	                    return row.name;
	                },
	                formatMatch: function(row, i, max) {
	                    return row.name;
	                },
	                formatResult: function(row) {
	                    return row.to;
	                },
	                del:function(id,nid,options){
	                	$.ajax({
							url : apiurl + 'deleteHistoryUser?id='+id,// ?loginId='+logintmp,
							type : 'POST',
							dataType : 'JSON',// here
							success : function(data) {
								alert(data.respMsg);
								if (data.respCode=='005') {
									delp("a1",id,"recieptDept");
								}
								//重新构建autocomplete
								function delp(aid,id,nid){
									var b = false;
									var pas2 = [],i2= 0;
									var params = History.params[aid];
									for (var i = 0; i < params.length; i++) {
										var p = params[i];
										if(p.id==id){
											b = true;
										}else{
											pas2[i2]=p;
											i2++;
										}
									}
									if(b){
										options.data= pas2;
										History.params[aid] = pas2;
										History.auto[nid].setOptions(options);
										//History.auto[nid].flushCache();
										//History.autocomplete(nid,pas2);
										return b;
									}
								}
							}
	                	});
	                }
	            });
				History.auto[id].result(function(event, row, formatted) {
	                //alert(row.id);
	            });
			}
		},
		//保存
		save:function(){
			$.ajax({
				url : apiurl + 'saveInvoice',// ?loginId='+logintmp,
				type : 'POST',
				dataType : 'JSON',// here
				data:{
					invoice:$("#recieptDept").val(),
				},
				success : function(data) {
					if (data.respCode=='004') {
						
					} else {
						
					}
				}
			});
		}
}
//下一步
function checkform1(){
	//检查时间录入
	 if(checkInputTime()){
		return false;
	} 
	var bts = timeLimit.busytimelist;		//繁忙时间
	var cts = timeLimit.closetimelist;		//停业时间
	for (var i = 0; i < cts.length; i++) {
		var bt = cts[i];
		if(checktime(bt.start,bt.end)){
			alert("繁忙时间不可订餐");
			return false;
		}
	}

	for (var i = 0; i < bts.length; i++) {
		var bt = bts[i];
		if(checktime(bt.start,bt.end)){
			alert("停业时间不可订餐");
			return false;
		}
	}

	if($("input[name='needReciept']:checked").val() == '1' &&$("input[name='recieptType']:checked").val() == '1' && $("input[name='recieptDept']").val() == ''){
		alert('请填写发票抬头');
		return false;
	}
	History.save();
	$('#orderform2').show();

	$('#orderform1').hide();

	$('#orderform1_btn').hide();

	$('#orderform2_btn').show();

	$('#orderform2_btn1').show();

	getfee();

}

function backform1(){

	$('#orderform1').show();$('#orderform2').hide();$('#orderform1_btn').show();$('#orderform2_btn').hide();$('#orderform2_btn1').hide();

}

</script>

<div class="btn_queren" id="orderform1_btn" style="margin-top:30px; cursor:pointer;" onclick="checkform1();">下一步</div>



<div class="btn_queren2 left" id="orderform2_btn" style="margin-top:30px; cursor:pointer; display:none;" onclick="backform1();">返回修改</div>



<div class="btn_queren2 right" id="orderform2_btn1" style="margin-top:30px; cursor:pointer; display:none;" onclick="orderform1();">确认提交</div>



</div>



<div class="mid_right m_t_20" >



<div class="title">个人信息</div>



<div id="userinfo">











</div>



<div class="mid_right m_t_5">



<div class="tishi"><span class="f_red ">提示</span></div>



</div>



</div>



<div class="clear"></div>



<div class="foot">



<span><a href="#">法律条款</a>| <a href="#">隐私条款</a>|<a href="#">联系我们</a>|<a href="#">加入我们</a></span>



<span class="p_l_20">京ICP备14061536号 Copyright 2015 海鸿达（北京）餐饮管理有限公司，All rights reserved</span>



<span class="p_l_15"><!--<select></select>--></span>



</div>



</div>







<div class="left right_01 m_t_15"><img src="images/right_img.jpg" width="170" border="0" usemap="#id_right_01Map" id="id_right_01"/>



  <map name="id_right_01Map" id="id_right_01Map">



    <area shape="rect" coords="1,4,24,22" href="#" onclick="right_ceng()" />



    <area shape="rect" coords="8,222,87,242" href="tencent://message/?uin=你的号码&Site=QQ客服&Menu=yes" />



    <area shape="rect" coords="92,223,163,241" href="tencent://message/?uin=你的号码&Site=QQ客服&Menu=yes"  />



  </map>



</div>







</div>



<div id="test"></div>



</body>



</html>



